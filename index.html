<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sohbet App</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
html,body{width:100%;height:100%;overflow:hidden;background:black;color:white;}
#splash{position:fixed;top:0;left:0;width:100%;height:100%;z-index:10;}
#splash video{width:100%;height:100%;object-fit:cover;}
#login{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:9;display:flex;align-items:center;justify-content:center;flex-direction:column;background:black;}
#login img{width:120px;cursor:pointer;margin-top:20px;}
#app{display:none;position:fixed;top:0;left:0;width:100%;height:100%;}
#bgVideo{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-1;}
#header{height:50px;display:flex;justify-content:space-between;align-items:center;padding:10px;background:rgba(0,0,0,0.6);}
#settingsBtn{font-size:24px;cursor:pointer;}
.card{margin:10px;padding:15px;border-radius:12px;background:rgba(0,0,0,0.7);}
.card h3{margin-bottom:10px;}
#taskList,#chatBox,#calendar{max-height:200px;overflow-y:auto;margin-top:5px;}
.task-btns,#msg-btns{display:flex;justify-content:space-around;margin-top:5px;}
button{padding:8px;border:none;border-radius:8px;cursor:pointer;}
#settings{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:black;padding:20px;overflow-y:auto;}
#settings button{width:48%;margin:5px 1%;background:#1abc9c;color:black;font-weight:bold;}
input,textarea{width:100%;padding:6px;margin-top:5px;border-radius:6px;border:none;}
</style>
</head>
<body>

<!-- SPLASH -->
<div id="splash">
<video src="splash.mp4" autoplay muted></video>
</div>

<!-- LOGIN -->
<div id="login">
<h2>Google ile giri≈ü</h2>
<img src="google-symbol.png" id="googleLogin">
</div>

<!-- APP -->
<div id="app">
<video id="bgVideo" src="bg.mp4" autoplay muted loop></video>

<div id="header">
<div id="userName">Ho≈ügeldin</div>
<div id="settingsBtn">‚öôÔ∏è</div>
</div>

<div class="card">
<h3>G√∂revler</h3>
<input id="taskInput" placeholder="G√∂rev ekle">
<input type="datetime-local" id="taskStart">
<input type="datetime-local" id="taskEnd">
<div class="task-btns">
<button onclick="addTask()">‚ûï Ekle</button>
<button onclick="deleteTask()">üóë Sil</button>
<button onclick="editTask()">‚úèÔ∏è D√ºzenle</button>
<button onclick="setAlarm()">‚è∞ Alarm</button>
</div>
<ul id="taskList"></ul>
</div>

<div class="card">
<h3>Mesajlar</h3>
<div id="chatBox"></div>
<input type="text" id="msgInput" placeholder="Mesaj yaz">
<input type="file" id="msgImg">
<div id="msg-btns">
<button onclick="sendMsg()">‚û§ G√∂nder</button>
<button onclick="deleteMsg()">üóë Sil</button>
</div>
</div>

<div class="card">
<h3>Takvim</h3>
<div id="calendar">Takvim paneli burada √ßalƒ±≈üacak</div>
</div>
</div>

<!-- SETTINGS -->
<div id="settings">
<h2>Ayarlar</h2>
<button onclick="backHome()">‚¨Ö Geri</button>
<button onclick="addAlarm()">‚è∞ Alarm ekle</button>
<button onclick="sendMail()">üìß G√∂r√º≈ü & √ñneri G√∂nder</button>
<button onclick="logout()">üö™ √áƒ±kƒ±≈ü</button>
<div id="adminPanel"></div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
apiKey: "AIzaSyDE5-fq9ifhtBlXTVOR1PhzD3XuVOWSVeE",
authDomain: "studio-3972799448-609d1.firebaseapp.com",
databaseURL: "https://studio-3972799448-609d1-default-rtdb.firebaseio.com",
projectId: "studio-3972799448-609d1",
storageBucket: "studio-3972799448-609d1.firebasestorage.app",
messagingSenderId: "210449601127",
appId: "1:210449601127:web:b3339666a09822b40c7ac2"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);
const provider = new GoogleAuthProvider();
const ADMIN="yasindemirkan83@gmail.com";

/* SPLASH -> LOGIN */
setTimeout(()=>{
document.getElementById("splash").style.display="none";
document.getElementById("login").style.display="flex";
},3000);

/* LOGIN */
document.getElementById("googleLogin").onclick=()=>{
signInWithPopup(auth,provider);
};

/* AUTH */
onAuthStateChanged(auth,(user)=>{
if(user){
document.getElementById("login").style.display="none";
document.getElementById("app").style.display="block";
document.getElementById("userName").innerText=user.displayName;
if(user.email===ADMIN) document.getElementById("adminPanel").innerHTML="<b>ADMIN PANEL</b>";
loadTasks();
loadMessages();
}
});

/* LOGOUT */
window.logout=()=>{
signOut(auth);
location.reload();
}

/* TASK FUNCTIONS */
function addTask(){
let val=document.getElementById("taskInput").value;
let start=document.getElementById("taskStart").value;
let end=document.getElementById("taskEnd").value;
if(!val) return;
let userId = auth.currentUser.uid;
let taskRef = ref(db,"tasks/"+userId);
push(taskRef,{title:val,start:start,end:end});
document.getElementById("taskInput").value="";
}
function loadTasks(){
let userId = auth.currentUser.uid;
let taskRef = ref(db,"tasks/"+userId);
onValue(taskRef,(snapshot)=>{
let taskList=document.getElementById("taskList");
taskList.innerHTML="";
snapshot.forEach(child=>{
let li=document.createElement("li");
li.innerText=child.val().title+" ("+child.val().start+" ‚Üí "+child.val().end+")";
taskList.appendChild(li);
});
});
}
function deleteTask(){
let userId = auth.currentUser.uid;
let taskRef = ref(db,"tasks/"+userId);
onValue(taskRef,(snapshot)=>{
snapshot.forEach(child=>{
child.ref.remove();
});
});
}
function editTask(){alert("Edit fonksiyonu eklenebilir");}
function setAlarm(){let t=prompt("Dakika gir:");if(t){setTimeout(()=>alert("Alarm!"),t*60000);}}

/* CHAT FUNCTIONS */
function sendMsg(){
let val=document.getElementById("msgInput").value;
let file=document.getElementById("msgImg").files[0];
let userId = auth.currentUser.uid;
let chatRef = ref(db,"messages/"+userId);
let msgData={text:val};
if(file){msgData.img=file.name;} // basit kayƒ±t
push(chatRef,msgData);
document.getElementById("msgInput").value="";
document.getElementById("msgImg").value="";
}
function loadMessages(){
let userId = auth.currentUser.uid;
let chatRef = ref(db,"messages/"+userId);
onValue(chatRef,(snapshot)=>{
let chatBox=document.getElementById("chatBox");
chatBox.innerHTML="";
snapshot.forEach(child=>{
let msg=child.val();
let div=document.createElement("div");
div.innerText=msg.text;
chatBox.appendChild(div);
});
});
}
function deleteMsg(){let userId = auth.currentUser.uid;let chatRef=ref(db,"messages/"+userId);onValue(chatRef,(snapshot)=>{snapshot.forEach(c=>c.ref.remove());});}

/* SETTINGS */
document.getElementById("settingsBtn").onclick=()=>{
document.getElementById("app").style.display="none";
document.getElementById("settings").style.display="block";
}
function backHome(){
document.getElementById("settings").style.display="none";
document.getElementById("app").style.display="block";
}
function sendMail(){
location.href="mailto:yasindemirkan83@gmail.com?subject=G√∂r√º≈ü & √ñneri&body=Mesajƒ±m:";
}
</script>

</body>
</html>
